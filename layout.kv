# To debug screens, uncomment the following lines:
############
#<Widget>:
#    canvas.after:
#        Line:
#            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
#            dash_offset: 5
#            dash_length: 3
############

<WhiteBorderedLabel>:
    canvas.after:
        Color:
            rgb: 1,1,1
        Line:
            rectangle: self.x+1,self.y+1,self.width-1,self.height-1

<ColoredBorderedLabel>:
    canvas.after:
        Color:
            rgb: 0.6,0.6,0.6
        Line:
            rectangle: self.x+1,self.y+1,self.width-1,self.height-1

<MainMenuScreen>:
    title: title
    about_label: about_label
    on_enter: root.load_ribbon()
    FloatLayout:
        canvas:
            Color:
                rgba: 1, 1, 1, 0.6
            Rectangle:
                size: self.size
                pos: self.pos
    	Label:
            id: title
            color: (0, 0.3, 0.8, 1)
            font_size: '24sp'
            text: 'OS - Algo Visualization App'
            size_hint: 0.173, 0.07
            pos_hint: {'x': .42, 'y': 0.94}
        Button:
        	text: 'CPU Scheduling Algorithms'
            size_hint: 0.6, 0.07
            pos_hint: {'x': .2, 'y': .85}
            on_press:
                root.manager.transition.direction = 'left'
                root.manager.current = 'cpu_form'
        Button:
        	text: 'Deadlock Avoidance Algorithm'
            size_hint: 0.6, 0.07
            pos_hint: {'x': .2, 'y': .75}
            on_press:
                root.manager.transition.direction = 'left'
                root.manager.current = 'da_form'
        Button:
        	text: 'Deadlock Detection Algorithm'
            size_hint: 0.6, 0.07
            pos_hint: {'x': .2, 'y': .65}
            on_press:
                root.manager.transition.direction = 'left'
                root.manager.current = 'dd_form'
        Button:
        	text: 'Contiguous Memory Allocation Strategies'
            size_hint: 0.6, 0.07
            pos_hint: {'x': .2, 'y': .55}
            on_press:
                root.manager.transition.direction = 'left'
                root.manager.current = 'mem_form'
        Button:
            text: 'Page Replacement Algorithms'
            size_hint: 0.6, 0.07
            pos_hint: {'x': .2, 'y': .45}
            on_press:
                root.manager.transition.direction = 'left'
                root.manager.current = 'page_form'
        Button:
            text: 'Disk Scheduling Algorithms'
            size_hint: 0.6, 0.07
            pos_hint: {'x': .2, 'y': .35}
            on_press:
                root.manager.transition.direction = 'left'
                root.manager.current = 'disk_form'
        #Image:
            #source: "images/nsit_logo.png"
            #size_hint: 0.2, 0.2
            #pos_hint: {'x': .4, 'y': .1}
        Button:
            size_hint: 0.2, 0.05
            pos_hint: {'x': 0.4, 'y': 0.2}
            text: 'About'
            on_press:
                root.about_label.text = 'Developers: Udit Arora, Namrata Mukhija, Priyanka, Rohit Takhar\nAdvisor: Dr. Pinaki Chakraborty'
        Label:
            id: about_label
            text: ''
            size_hint: 0.6, 0.06
            pos_hint: {'x': .2, 'y': .02}

<CPUInputScreen>:
    on_pre_enter: root.bind_widgets()
    layout_form: layout_form
    num_processes: num_processes
    dispatch_latency: dispatch_latency
    algo_spinner: algo_spinner
    variant_spinner: variant_spinner
    #queue_spinner: queue_spinner
    visualize_button: visualize_button
    BoxLayout:
        canvas:
            Color:
                rgba: 1, 1, 1, 0.5
            Rectangle:
                size: self.size
                pos: self.pos
        orientation: 'vertical'
        BoxLayout:
            orientation: 'horizontal'
            padding: '10dp', '5dp'
            size_hint_y: 0.15
            #size_hint_x: 0.5
            pos_hint: {'top': 1}
            Label:
                text: 'Number of processes: '
                size_hint_x: 0.3
            TextInput:
                id: num_processes
                multiline: 'False'
                size_hint_x: 0.2
            Label:
                size_hint_x: 0.05
                text: ''
            Label:
                text: 'Dispatch Latency: '
                size_hint_x: 0.3
            TextInput:
                id: dispatch_latency
                multiline: 'False'
                size_hint_x: 0.2
            Label:
                size_hint_x: 0.05
                text: ''
            #Button:
                #size_hint_x: 0.2
                #size_hint_y: 0.8
                #halign: 'center'
                #valign: 'middle'
                #text: 'Load form'
                #on_release: root.load_form()
        Label:
            text: 'Information about the scheduling algorithm:'
            size_hint_y: 0.1
            text_size: self.size
            padding: '10dp', 0
            halign: 'left'
        BoxLayout:
            orientation: 'horizontal'
            padding: '5dp', '20dp'
            size_hint_x: 0.6
            size_hint_y: 0.2
            Label:
                text: 'Algorithm:'
                size_hint_x: 0.4
                text_size: self.size
                #pos_hint: {'top': 1}
                padding: '5dp', '5dp'
            Spinner:
                id: algo_spinner
                text:'Select an algorithm'
                size_hint_y: 'None'
                height: '40dp'
                values: ('First Come First Serve', 'Shortest Job First', 'Priority', 'Round Robin', 'Multilevel Queue', 'Multilevel Feedback Queue')
        BoxLayout:
            orientation: 'horizontal'
            size_hint_y: 0.15
            size_hint_x: 0.5
            padding: '5dp', '5dp'
            Label:
                text: 'Variant'
                size_hint_x: 0.4
                text_size: self.size
                padding: '5dp', 0
            Spinner:
                id: variant_spinner
                text:'-'
                size_hint_y: 'None'
                height: '40dp'
                values: ('Preemptive', 'Non-Preemptive')
                disabled: True
            Label:
                text: ''
                size_hint_x: 0.05
            #Button:
                #text: 'Visualize'
                #size_hint_x: 0.2
                #size_hint_y: None
                #height: '40dp'
                #on_release: 
                    #root.manager.transition.direction = 'left'
                    #root.manager.current = 'cpu_output'
        # For adding scroll view directly from KV file (also need to call bind function)
        #ScrollView
           #size: self.size
           #GridLayout:
                #id: layout
                #cols: 1
                #size_hint_y: None
                #height: '2000dp'
        BoxLayout:
            id: layout_form
            orientation: 'vertical'
        GridLayout:
            size_hint_y: None
            height: '35dp'
            cols: 2
            Button:
                text: 'Back'
                on_release:
                    root.manager.transition.direction = 'right'
                    root.manager.current = 'menu'
            Button:
                id: visualize_button
                text: 'Visualize'
                disabled: True
                on_release:
                    root.manager.transition.direction = 'left'
                    root.manager.current = 'cpu_output'

<CPUOutputScreen>:
    layout: layout
    gantt: gantt
    time: time
    desc: desc
    on_pre_enter: root.calculate_schedule()
    on_enter: root.draw_gantt()
    BoxLayout:
        orientation: 'vertical'
        BoxLayout:
            size_hint_y: 0.3
            orientation: 'vertical'
            id: desc
        BoxLayout:
            size_hint_y: 0.4
            orientation: 'horizontal'
            id: gantt
        BoxLayout:
            size_hint_y: 0.07
            orientation: 'horizontal'
            id: time
        Label:
            text: 'Timeline -'
            size_hint_y: 0.07
            #padding: 100, 0
            #text_size: self.size
            #halign: 'left'
        BoxLayout:
            size_hint_y: 0.07
            orientation: 'horizontal'
            Label:
                text: 'Process'
            Label:
                text: 'Start/Resume time'
            Label:
                text: 'Suspend/Termination time'
            Label:
                text: ''
        BoxLayout:
            size_hint_y: 0.5
            orientation: 'vertical'
            id: layout
        GridLayout:
            size_hint_y: None
            height: '35dp'
            cols: 2
            Button:
                text: 'Back'
                on_press:
                    root.manager.transition.direction = 'right'
                    root.manager.current = 'cpu_form'
            Button:
                text: 'Exit'
                on_press: app.stop()

<CPUOutputScreenMultilevel>:
    layout: layout
    gantt: gantt
    gantt_queue: gantt_queue
    time: time
    time_queue: time_queue
    desc: desc
    on_pre_enter: root.calculate_schedule()
    on_enter: root.draw_gantt()
    BoxLayout:
        orientation: 'vertical'
        BoxLayout:
            size_hint_y: 0.3
            orientation: 'vertical'
            id: desc
        BoxLayout:
            size_hint_y: 0.35
            orientation: 'horizontal'
            id: gantt
        BoxLayout:
            size_hint_y: 0.07
            orientation: 'horizontal'
            id: time
        BoxLayout:
            size_hint_y: 0.35
            orientation: 'horizontal'
            id: gantt_queue
        BoxLayout:
            size_hint_y: 0.07
            orientation: 'horizontal'
            id: time_queue
        Label:
            text: 'Timeline -'
            size_hint_y: 0.07
            #padding: 100, 0
            #text_size: self.size
            #halign: 'left'
        BoxLayout:
            size_hint_y: 0.07
            orientation: 'horizontal'
            Label:
                text: 'Process'
            Label:
                text: 'Start/Resume time'
            Label:
                text: 'Suspend/Termination time'
            Label:
                text: ''
        BoxLayout:
            size_hint_y: 0.4
            orientation: 'vertical'
            id: layout
        GridLayout:
            size_hint_y: None
            height: '35dp'
            cols: 2
            Button:
                text: 'Back'
                on_press:
                    root.manager.transition.direction = 'right'
                    root.manager.current = 'cpu_form'
            Button:
                text: 'Exit'
                on_press: app.stop()

<DeadlockAvoidanceInputScreen>:
    on_pre_enter: root.bind_widgets()
    num_processes: num_processes
    num_resource_types: num_resource_types
    form: form
    visualize_button: visualize_button
    #request_form: request_form
    #request_process: request_process
    BoxLayout:
        canvas:
            Color:
                rgba: 1, 1, 1, 0.5
            Rectangle:
                size: self.size
                pos: self.pos
        orientation: 'vertical'
        BoxLayout:
            orientation: 'horizontal'
            padding: '10dp', '2.5dp'
            size_hint_y: 0.08
            size_hint_x: 0.3
            pos_hint: {'top': 1}
            Label:
                size_hint_x: 0.6
                text: 'No. of processes:'
                text_size: self.size
                halign: 'left'
            TextInput:
                size_hint_x: 0.4
                id: num_processes
                multiline: 'False'
        BoxLayout:
            orientation: 'horizontal'
            padding: '10dp', '5dp'
            size_hint_y: 0.08
            size_hint_x: 0.7
            Label:
                size_hint_x: 0.25
                valign: 'middle'
                text: 'No. of resource types:'
                text_size: self.size
            TextInput:
                size_hint_x: 0.125
                id: num_resource_types
                multiline: 'False'
            Label:
                size_hint_x: 0.3
            #Button:
                #size_hint_x: 0.15
                #text: 'Load form'
                #on_release: root.load_form()
        #Label:
            #text: 'Information about the current state -'
            #size_hint_y: 0.07
        BoxLayout:
            orientation: 'vertical'
            id: form
        GridLayout:
            size_hint_y: None
            height: '35dp'
            cols: 2
            Button:
                text: 'Back'
                on_release:
                    root.manager.transition.direction = 'right'
                    root.manager.current = 'menu'
            Button:
                id: visualize_button
                text: 'Visualize'
                disabled: True
                on_release:
                    root.manager.transition.direction = 'left'
                    root.manager.current = 'da_output'

<DeadlockAvoidanceOutputScreen>:
    on_pre_enter: root.calculate()
    layout: layout
    BoxLayout:
        orientation: 'vertical'
        BoxLayout:
            orientation: 'vertical'
            #size_hint_y: 0.9
            id: layout
        GridLayout:
            size_hint_y: None
            height: '35dp'
            cols: 2
            Button:
                text: 'Back'
                on_press:
                    root.manager.transition.direction = 'right'
                    root.manager.current = 'da_form'
            Button:
                text: 'Exit'
                on_press: app.stop()

<DeadlockDetectionInputScreen>:
    on_pre_enter: root.bind_widgets()
    num_processes: num_processes
    num_resource_types: num_resource_types
    form: form
    visualize_button: visualize_button
    #request_form: request_form
    #request_process: request_process
    BoxLayout:
        canvas:
            Color:
                rgba: 1, 1, 1, 0.5
            Rectangle:
                size: self.size
                pos: self.pos
        orientation: 'vertical'
        BoxLayout:
            orientation: 'horizontal'
            padding: '10dp', '2.5dp'
            size_hint_y: 0.08
            size_hint_x: 0.3
            pos_hint: {'top': 1}
            Label:
                size_hint_x: 0.6
                text: 'No. of processes:'
                text_size: self.size
                halign: 'left'
            TextInput:
                size_hint_x: 0.4
                id: num_processes
                multiline: 'False'
        BoxLayout:
            orientation: 'horizontal'
            padding: '10dp', '5dp'
            size_hint_y: 0.08
            size_hint_x: 0.7
            Label:
                size_hint_x: 0.25
                valign: 'middle'
                text: 'No. of resource types:'
                text_size: self.size
            TextInput:
                size_hint_x: 0.125
                id: num_resource_types
                multiline: 'False'
            Label:
                size_hint_x: 0.3
            #Button:
                #size_hint_x: 0.15
                #text: 'Load form'
                #on_release: root.load_form()
        BoxLayout:
            orientation: 'vertical'
            id: form
        GridLayout:
            size_hint_y: None
            height: '35dp'
            cols: 2
            Button:
                text: 'Back'
                on_release:
                    root.manager.transition.direction = 'right'
                    root.manager.current = 'menu'
            Button:
                id: visualize_button
                text: 'Visualize'
                disabled: True
                on_release:
                    root.manager.transition.direction = 'left'
                    root.manager.current = 'dd_output'

<DeadlockDetectionOutputScreen>:
    on_pre_enter: root.calculate()
    layout: layout
    BoxLayout:
        orientation: 'vertical'
        id: layout
    GridLayout:
        size_hint_y: None
        height: '35dp'
        cols: 2
        Button:
            text: 'Back'
            on_press:
                root.manager.transition.direction = 'right'
                root.manager.current = 'dd_form'
        Button:
            text: 'Exit'
            on_press: app.stop()

<MemoryInputScreen>:
    on_pre_enter: root.bind_widgets()
    num_processes: num_processes
    mem_size: mem_size
    algo_spinner: algo_spinner
    visualize_button: visualize_button
    form: form
    BoxLayout:
        canvas:
            Color:
                rgba: 1, 1, 1, 0.5
            Rectangle:
                size: self.size
                pos: self.pos
        orientation: 'vertical'
        BoxLayout:
            orientation: 'horizontal'
            padding: '10dp', '5dp'
            size_hint_y: 0.1
            size_hint_x: 0.3
            pos_hint: {'top': 1}
            Label:
                size_hint_x: 0.6
                text: 'No. of processes:'
                text_size: self.size
                halign: 'left'
            TextInput:
                size_hint_x: 0.4
                id: num_processes
                multiline: 'False'
        BoxLayout:
            orientation: 'horizontal'
            padding: '10dp', '5dp'
            size_hint_y: 0.1
            size_hint_x: 0.7
            Label:
                size_hint_x: 0.3
                valign: 'middle'
                text: 'Size of Main Memory (KB):'
                text_size: self.size
            TextInput:
                size_hint_x: 0.125
                id: mem_size
                multiline: 'False'
            Label:
                size_hint_x: 0.3
        BoxLayout:
            orientation: 'horizontal'
            padding: '5dp', '10dp'
            size_hint_y: 0.2
            #height: '100dp'
            Label:
                text: 'Algorithm:'
                size_hint_x: 0.3
                text_size: self.size
                #pos_hint: {'top': 1}
                padding: '10dp', '10dp'
            Spinner:
                id: algo_spinner
                text:'Select an algorithm'
                size_hint_y: 'None'
                height: '40dp'
                values: ('First Fit', 'Best Fit', 'Worst Fit')
            Label:
                size_hint_x: 0.3
        BoxLayout:
            orientation: 'vertical'
            id: form
        GridLayout:
            size_hint_y: None
            height: '35dp'
            cols: 2
            Button:
                text: 'Back'
                on_release:
                    root.manager.transition.direction = 'right'
                    root.manager.current = 'menu'
            Button:
                id: visualize_button
                text: 'Visualize'
                disabled: True
                on_release:
                    root.manager.transition.direction = 'left'
                    root.manager.current = 'mem_output'

<MemoryOutputScreen>:
    on_pre_enter: root.calculate()
    layout: layout
    BoxLayout:
        orientation: 'vertical'
        BoxLayout:
            orientation: 'vertical'
            id: layout
        GridLayout:
            size_hint_y: None
            height: '35dp'
            cols: 2
            Button:
                text: 'Back'
                on_press:
                    root.manager.transition.direction = 'right'
                    root.manager.current = 'mem_form'
            Button:
                text: 'Exit'
                on_press: app.stop()

<PageInputScreen>:
    on_pre_enter: root.bind_widgets()
    num_frames: num_frames
    form: form
    algo_spinner: algo_spinner
    visualize_button: visualize_button
    BoxLayout:
        canvas:
            Color:
                rgba: 1, 1, 1, 0.5
            Rectangle:
                size: self.size
                pos: self.pos
        orientation: 'vertical'
        BoxLayout:
            orientation: 'horizontal'
            padding: '30dp', '5dp'
            size_hint_y: 0.1
            size_hint_x: 0.7
            Label:
                size_hint_x: 0.25
                valign: 'middle'
                text: 'Number of frames:'
                text_size: self.size
            TextInput:
                size_hint_x: 0.125
                id: num_frames
                multiline: 'False'
        BoxLayout:
            orientation: 'horizontal'
            padding: '5dp', '10dp'
            size_hint_y: 0.2
            Label:
                text: 'Algorithm:'
                size_hint_x: 0.3
                text_size: self.size
                #pos_hint: {'top': 1}
                padding: '10dp', '10dp'
            Spinner:
                id: algo_spinner
                text:'Select an algorithm'
                size_hint_y: 'None'
                height: '40dp'
                values: ('First In First Out', 'Optimal', 'Least Recently Used', 'Second Chance', 'Enhanced Second Chance', 'Least Frequently Used', 'Most Frequently Used')
            Label:
                size_hint_x: 0.3
        BoxLayout:
            orientation: 'vertical'
            id: form
        GridLayout:
            size_hint_y: None
            height: '35dp'
            cols: 2
            Button:
                text: 'Back'
                on_release:
                    root.manager.transition.direction = 'right'
                    root.manager.current = 'menu'
            Button:
                id: visualize_button
                text: 'Visualize'
                disabled: True
                on_release:
                    root.manager.transition.direction = 'left'
                    root.manager.current = 'page_output'

<PageOutputScreen>:
    on_pre_enter: root.calculate()
    layout: layout
    BoxLayout:
        orientation: 'vertical'
        BoxLayout:
            orientation: 'vertical'
            id: layout
        GridLayout:
            size_hint_y: None
            height: '35dp'
            cols: 2
            Button:
                text: 'Back'
                on_press:
                    root.manager.transition.direction = 'right'
                    root.manager.current = 'page_form'
            Button:
                text: 'Exit'
                on_press: app.stop()


<DiskInputScreen>:
    on_pre_enter: root.bind_widgets()
    num_cylinders: num_cylinders
    form: form
    pos_head: pos_head
    algo_spinner: algo_spinner
    visualize_button: visualize_button
    BoxLayout:
        canvas:
            Color:
                rgba: 1, 1, 1, 0.5
            Rectangle:
                size: self.size
                pos: self.pos
        orientation: 'vertical'
        BoxLayout:
            orientation: 'horizontal'
            padding: '10dp', '5dp'
            size_hint_y: 0.15
            #size_hint_x: 0.5
            pos_hint: {'top': 1}
            Label:
                text: 'Number of cylinders in disk: '
                size_hint_x: 0.3
            TextInput:
                id: num_cylinders
                multiline: 'False'
                size_hint_x: 0.2
            Label:
                size_hint_x: 0.05
                text: ''
        BoxLayout:
            orientation: 'horizontal'
            padding: '10dp', '5dp'
            size_hint_y: 0.15
            #size_hint_x: 0.5
            pos_hint: {'top': 1}
            Label:
                text: 'Current Position of read/write head: '
                size_hint_x: 0.3
            TextInput:
                id: pos_head
                multiline: 'False'
                size_hint_x: 0.2
            Label:
                size_hint_x: 0.05
                text: ''
        BoxLayout:
            orientation: 'horizontal'
            padding: '5dp', '20dp'
            height: '100dp'
            size_hint_y: None
            Label:
                text: 'Algorithm:'
                size_hint_x: 0.3
                text_size: self.size
                #pos_hint: {'top': 1}
                padding: '10dp', '10dp'
            Spinner:
                id: algo_spinner
                text:'Select an algorithm'
                size_hint_y: 'None'
                height: '40dp'
                values: ('First Come First Served', 'Shortest Seek Time First', 'SCAN', 'C-SCAN', 'LOOK', 'C-LOOK')
        BoxLayout:
            id: form
            orientation: 'vertical'
        GridLayout:
            size_hint_y: None
            height: '35dp'
            cols: 2
            Button:
                text: 'Back'
                on_release:
                    root.manager.transition.direction = 'right'
                    root.manager.current = 'menu'
            Button:
                id: visualize_button
                text: 'Visualize'
                disabled: True
                on_release:
                    root.manager.transition.direction = 'left'
                    root.manager.current = 'disk_output'

<DiskOutputScreen>:
    on_pre_enter: root.calculate()
    layout: layout
    BoxLayout:
        orientation: 'vertical'
        BoxLayout:
            orientation: 'vertical'
            id: layout
        GridLayout:
            size_hint_y: None
            height: '35dp'
            cols: 2
            Button:
                text: 'Back'
                on_press:
                    root.manager.transition.direction = 'right'
                    root.manager.current = 'disk_form'
            Button:
                text: 'Exit'
                on_press: app.stop()

